<html>
	<head>
		<meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<meta name="apple-mobile-web-app-capable" content="yes">
	</head>
	
	<canvas id=canvas width=320px height=460px style='border:1px solid black;position:absolute;top:0px;left:0px'>
	</canvas>
	<script>
		var canvas = document.getElementById('canvas');
		var ctx = canvas.getContext('2d');
		function pre_preload(){
			if(window.innerHeight > window.innerWidth){preload()}
			else{alert('Please hold the device vertically')
			setTimeout(pre_preload,3000)}
		}
		window.onload=pre_preload()
		function preload(){
			canvas_width = window.innerWidth;
			canvas_height = window.innerHeight;
			canvas.setAttribute('width',canvas_width)
			canvas.setAttribute('height',canvas_height)
			load_images()
		}
		function load_images(){
			handle_image_load()
		}
		function handle_image_load(){
			var num_of_images = num_of_images||0;
			num_of_images ++
			if(num_of_images == 1){init()}
		}
		//
		//
		//
		//
		//
		var alpha = 255
		var beta = 255
		var gamma = 255
		function init(){
			change_bg_color()
			game_loop()
		}
		
		function game_loop(){
			draw_background()
			draw_box()
			calc_diff()
			requestAnimationFrame(game_loop)
		}
		function draw_background(){
			ctx.fillStyle=background_color;
			ctx.fillRect(0,0,canvas_width,canvas_height)
		}
		function draw_box(){
			var x = canvas_width/4
			var y = x*5/4
			
			box1_red = Math.floor((2.8*beta)+127)
			box1_green = Math.floor((2.8*alpha)+127)
			box1_blue = Math.floor((2.8*gamma)+127)
			
			ctx.fillStyle='rgb('+box1_red+','+box1_green+','+box1_blue+')'
			ctx.fillRect(x,y,2*x,8/3*y)
			//console.log(box1_color)
		}
		
		function change_bg_color(){
			c1 = Math.floor(Math.random()*255)
			c2 = Math.floor(Math.random()*255)
			c3 = Math.floor(Math.random()*255)
			background_color = 'rgb('+c1+','+c2+','+c3+')'
		}
		function calc_diff(){
			if(Math.abs(c1-box1_red) < 10 && Math.abs(c2-box1_green) < 10 && Math.abs(c3-box1_blue) < 10){alert('win')}
		}
		
		window.ondeviceorientation = function (e){
			alpha = Math.floor(e.alpha) //Tilt (y-axis) in degrees
			beta = Math.floor(e.beta) //Tilt (z-axis)in degrees
			gamma = Math.floor(e.gamma) //Tilt (x-axis)
			
		}
	</script>
</html>